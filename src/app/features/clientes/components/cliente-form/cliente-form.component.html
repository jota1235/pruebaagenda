<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="confirmCancel()">
        <ion-icon slot="icon-only" name="arrow-back-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>{{ pageTitle }}</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="saveCliente()" [disabled]="clienteForm.invalid">
        <ion-icon slot="icon-only" name="save-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <form [formGroup]="clienteForm" class="cliente-form">
    <ion-list>
      <!-- Nombre -->
      <ion-item [class.ion-invalid]="hasError('nombre')" [class.ion-touched]="clienteForm.get('nombre')?.touched">
        <ion-label position="stacked">
          <ion-icon name="person-outline" class="field-icon"></ion-icon>
          Nombre *
        </ion-label>
        <ion-input
          formControlName="nombre"
          type="text"
          placeholder="Ingresa el nombre"
          autocapitalize="words">
        </ion-input>
        <ion-note slot="error" *ngIf="hasError('nombre')">
          {{ getErrorMessage('nombre') }}
        </ion-note>
      </ion-item>

      <!-- Apellido -->
      <ion-item [class.ion-invalid]="hasError('apellido')" [class.ion-touched]="clienteForm.get('apellido')?.touched">
        <ion-label position="stacked">
          <ion-icon name="person-outline" class="field-icon"></ion-icon>
          Apellido *
        </ion-label>
        <ion-input
          formControlName="apellido"
          type="text"
          placeholder="Ingresa el apellido"
          autocapitalize="words">
        </ion-input>
        <ion-note slot="error" *ngIf="hasError('apellido')">
          {{ getErrorMessage('apellido') }}
        </ion-note>
      </ion-item>

      <!-- Teléfono -->
      <ion-item [class.ion-invalid]="hasError('telefono')" [class.ion-touched]="clienteForm.get('telefono')?.touched">
        <ion-label position="stacked">
          <ion-icon name="call-outline" class="field-icon"></ion-icon>
          Teléfono *
        </ion-label>
        <ion-input
          formControlName="telefono"
          type="tel"
          placeholder="10 dígitos"
          maxlength="10"
          inputmode="numeric">
        </ion-input>
        <ion-note slot="error" *ngIf="hasError('telefono')">
          {{ getErrorMessage('telefono') }}
        </ion-note>
      </ion-item>

      <!-- Email -->
      <ion-item [class.ion-invalid]="hasError('email')" [class.ion-touched]="clienteForm.get('email')?.touched">
        <ion-label position="stacked">
          <ion-icon name="mail-outline" class="field-icon"></ion-icon>
          Email
        </ion-label>
        <ion-input
          formControlName="email"
          type="email"
          placeholder="correo@ejemplo.com"
          autocapitalize="none">
        </ion-input>
        <ion-note slot="error" *ngIf="hasError('email')">
          {{ getErrorMessage('email') }}
        </ion-note>
      </ion-item>

      <!-- Fecha de Nacimiento -->
      <ion-item>
        <ion-label position="stacked">
          <ion-icon name="calendar-outline" class="field-icon"></ion-icon>
          Fecha de Nacimiento
        </ion-label>
        <ion-input
          formControlName="fecha_nacimiento"
          type="date">
        </ion-input>
      </ion-item>

      <!-- Género -->
      <ion-item>
        <ion-label position="stacked">
          <ion-icon name="transgender-outline" class="field-icon"></ion-icon>
          Género
        </ion-label>
        <ion-select formControlName="genero" placeholder="Selecciona género">
          <ion-select-option value="Masculino">Masculino</ion-select-option>
          <ion-select-option value="Femenino">Femenino</ion-select-option>
          <ion-select-option value="Otro">Otro</ion-select-option>
          <ion-select-option value="Prefiero no decir">Prefiero no decir</ion-select-option>
        </ion-select>
      </ion-item>

      <!-- Notas -->
      <ion-item>
        <ion-label position="stacked">
          <ion-icon name="document-text-outline" class="field-icon"></ion-icon>
          Notas
        </ion-label>
        <ion-textarea
          formControlName="notas"
          placeholder="Observaciones, alergias, preferencias, etc."
          rows="4"
          autocapitalize="sentences">
        </ion-textarea>
      </ion-item>
    </ion-list>

    <!-- Botón guardar (móvil) -->
    <div class="form-actions">
      <ion-button
        expand="block"
        (click)="saveCliente()"
        [disabled]="clienteForm.invalid"
        class="save-button">
        <ion-icon slot="start" name="save-outline"></ion-icon>
        {{ isEditMode ? 'Actualizar Cliente' : 'Guardar Cliente' }}
      </ion-button>

      <ion-button
        expand="block"
        fill="outline"
        (click)="confirmCancel()"
        class="cancel-button">
        Cancelar
      </ion-button>
    </div>

    <!-- Nota de campos obligatorios -->
    <div class="required-note">
      <ion-note>* Campos obligatorios</ion-note>
    </div>
  </form>
</ion-content>
